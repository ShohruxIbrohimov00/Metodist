{% load static %}

<div class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden flex flex-col min-h-full">
    
    <div class="h-44 relative bg-gradient-to-br from-indigo-600 to-purple-600 group">
        {% if course.course_img %}
            <img src="{{ course.course_img.url }}"
                 class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                 alt="{{ course.title }} rasmi">
        {% else %}
            <div class="w-full h-full flex items-center justify-center text-white/40 text-7xl">
                <i class="fas fa-book-open"></i>
            </div>
        {% endif %}

        <div class="absolute top-3 right-3">
            {% if course.is_premium %}
                <span class="px-2 py-1 text-xs font-bold bg-yellow-50 text-amber-700 border border-amber-200 rounded-lg shadow">
                    <i class="fas fa-crown text-amber-500 mr-1"></i>Premium
                </span>
            {% else %}
                <span class="px-2 py-1 text-xs font-bold bg-green-50 text-green-700 border border-green-200 rounded-lg shadow">
                    <i class="fas fa-check-circle text-green-500 mr-1"></i>Bepul
                </span>
            {% endif %}
        </div>
    </div>

    <div class="p-5 flex flex-col flex-grow">

        <h2 class="text-xl font-extrabold text-slate-900 line-clamp-2 min-h-[3rem]">
            {{ course.title }}
        </h2>
        <p class="text-slate-500 text-sm mt-1 line-clamp-3 min-h-[3.9rem]">
            {{ course.description|truncatechars:110 }}
        </p>

        <div class="grid grid-cols-3 gap-3 mt-5 text-center">

            <div class="p-2 bg-indigo-50 rounded-xl border border-indigo-100">
                <i class="fas fa-layer-group text-indigo-600 mb-1"></i>
                <p class="font-bold text-slate-800">{{ course.total_modules|default:"0" }}</p>
                <p class="text-[10px] text-gray-500 uppercase">Modul</p>
            </div>

            <div class="p-2 bg-green-50 rounded-xl border border-green-100">
                <i class="fas fa-video text-green-600 mb-1"></i>
                <p class="font-bold text-slate-800">{{ course.total_lessons|default:"0" }}</p>
                <p class="text-[10px] text-gray-500 uppercase">Dars</p>
            </div>

            <div class="p-2 bg-pink-50 rounded-xl border border-pink-100">
                <i class="fas fa-clipboard-check text-pink-600 mb-1"></i>
                <p class="font-bold text-slate-800">{{ course.total_exams|default:"0" }}</p>
                <p class="text-[10px] text-gray-500 uppercase">Test</p>
            </div>

        </div>

        <div class="mt-5 p-3 bg-red-50 rounded-xl border border-red-200 flex gap-3">
            <div class="w-8 h-8 bg-red-200 rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-lock text-red-700"></i>
            </div>
            <p class="text-xs text-gray-700 leading-tight">
                Keyingi darsga o'tish uchun oldingi testni kamida
                <span class="font-extrabold text-red-900">{{ course.pass_threshold|default:"60" }}%</span>
                bilan o'ting.
            </p>
        </div>

        <div class="mt-4 space-y-1 text-xs">
            <p class="flex items-center text-gray-600">
                <i class="fas fa-chalkboard-teacher text-indigo-500 mr-2"></i>
                Ustoz: <span class="ml-1 font-semibold text-slate-800">{{ course.teacher.full_name }}</span>
            </p>

            {% if course.students_count > 0 %}
            <p class="flex items-center text-gray-600">
                <i class="fas fa-users text-green-500 mr-2"></i>
                O'quvchilar soni: <span class="ml-1 font-semibold text-slate-800">{{ course.students_count }}</span>
            </p>
            {% endif %}
        </div>

        <div class="mt-auto pt-4 space-y-2">

            {% if is_enrolled %}
                <a href="{% url 'course_roadmap' center.slug course.id %}"
                   class="block w-full text-center py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl shadow hover:scale-[1.01] active:scale-[0.98] transition">
                    <i class="fas fa-play mr-2"></i>Davom ettirish
                </a>
            {% else %}
                <a href="{% url 'course_detail' center.slug course.id %}"
                   class="block w-full text-center py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl shadow hover:scale-[1.01] active:scale-[0.98] transition">
                    <i class="fas fa-arrow-right mr-2"></i>Batafsil koâ€˜rish
                </a>
            {% endif %}

        </div>
    </div>
</div>