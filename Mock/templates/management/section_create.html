{% extends 'base.html' %}
{% load static i18n %}

{% block title %}Yangi bo'lim qo'shish (1-Bosqich){% endblock %}

{% block head %}
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<style>
    .errorlist { color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem; }
    /* Select2 uchun kerakli stil */
    .select2-container .select2-selection--single { height: 2.5rem; padding: 0.5rem; border: 1px solid #d1d5db !important; border-radius: 0.375rem; }
    .select2-container--classic .select2-selection--single .select2-selection__arrow { height: 2.5rem; }
    .btn { 
        display: inline-flex; 
        align-items: center; 
        padding: 0.5rem 1rem; 
        font-weight: 600; 
        border-radius: 0.375rem; 
        transition: all 0.3s; 
    }
    .btn-primary { background-color: #3b82f6; color: white; }
    .btn-primary:hover { background-color: #2563eb; }
    .btn-secondary { background-color: #6b7280; color: white; }
    .btn-secondary:hover { background-color: #4b5563; }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto p-4 md:p-8 max-w-5xl">
    <div class="bg-white shadow-xl rounded-xl p-6 md:p-8 border border-gray-100">
        <h2 class="text-3xl font-extrabold text-gray-900 mb-2">{% trans "Yangi bo'lim qo'shish" %} <span class="text-indigo-600">(1-Bosqich)</span></h2>
        <p class="text-gray-600 mb-8 border-b pb-4">{% trans "Bo'limning asosiy ma'lumotlarini kiriting va saqlang." %}</p>

        {% if messages %}
        <div class="mb-6">
            {% for message in messages %}
            <div class="p-4 mb-3 text-sm rounded-lg shadow-sm 
                {% if message.tags == 'success' %}bg-green-100 text-green-800 border-green-400{% elif message.tags == 'error' %}bg-red-100 text-red-800 border-red-400{% else %}bg-blue-100 text-blue-800 border-blue-400{% endif %} border-l-4" role="alert">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <form action="{% url 'section_create' slug=center.slug %}" method="POST" id="section-form" class="space-y-8">
            {% csrf_token %}

            <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-cubes mr-3 text-indigo-600"></i>{% trans "Bo'lim ma'lumotlari" %}
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {% for field in form %}
                    {% if field.name != 'selected_questions_ids' %}
                    <div class="space-y-1">
                        <label for="{{ field.id_for_label }}" class="block text-gray-700 font-medium">{{ field.label }}</label>
                        {{ field }}
                        {% if field.help_text %}
                            <p class="text-xs text-gray-500">{{ field.help_text }}</p>
                        {% endif %}
                        {% if field.errors %}
                        <ul class="errorlist">{{ field.errors }}</ul>
                        {% endif %}
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>

            <div class="flex flex-col sm:flex-row justify-end mt-6 space-y-3 sm:space-y-0 sm:space-x-3 border-t pt-6">
                <a href="{% url 'section_list' slug=center.slug %}" class="btn btn-secondary">
                    <i class="fas fa-times mr-2"></i>{% trans "Bekor qilish" %}
                </a>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-arrow-right mr-2"></i>{% trans "Keyingi bosqich (Savollarni tanlash)" %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_body %}
<script>
$(document).ready(function() {
    // Select2 ni ishga tushirish
    $('select').select2({
        theme: "classic",
        width: '100%',
        allowClear: true,
        placeholder: "{% trans 'Tanlang...' %}"
    });
});
</script>
{% endblock %}