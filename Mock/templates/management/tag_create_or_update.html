{% extends 'base.html' %} 
{% load static i18n widget_tweaks %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
{# Tailwind CSS va Font Awesome base.html da bo'lishi tavsiya etiladi. #}
<style>
    /* Umumiy tugmalar */
    .btn { 
        display: inline-flex; 
        align-items: center; 
        padding: 0.6rem 1.25rem; /* Kattaroq padding */
        font-weight: 600; 
        border-radius: 0.5rem; /* Yumaloqroq burchaklar */
        transition: all 0.3s; 
    }
    .btn-primary { background-color: #4f46e5; color: white; } 
    .btn-primary:hover { background-color: #4338ca; }
    .btn-secondary { background-color: #e5e7eb; color: #4b5563; } /* gray-200/gray-600 */
    .btn-secondary:hover { background-color: #d1d5db; }

    /* Forma nazoratlari (Sizning uslubingizga mos) */
    .form-control {
        border: 1px solid #d1d5db; /* gray-300 */
        border-radius: 0.5rem; /* rounded-lg */
        padding: 0.75rem 1rem; /* Kattaroq padding */
        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        font-size: 1rem;
    }
    .form-control:focus {
        border-color: #4f46e5; /* indigo-600 */
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
        outline: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto p-4 md:p-8 max-w-4xl">
    <div class="bg-white shadow-2xl rounded-xl p-6 sm:p-8 md:p-10 border border-gray-100">
        
        {# Sarlavha: Tahrirlash/Yaratish rejimiga qarab farqlanadi #}
        <h2 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-2 text-center">
            {{ title }}
        </h2>
        <p class="text-center text-gray-500 mb-8">
            {% if form.instance.pk %}
                {% trans "Mavjud teg ma'lumotlarini o'zgartiring." %}
            {% else %}
                {% trans "Yangi teg yaratish uchun maydonlarni to'ldiring." %}
            {% endif %}
        </p>
        <hr class="mb-8 border-indigo-100">
        
        {# Forma bo'yicha umumiy xatolar #}
        {% if form.non_field_errors %}
            <div class="p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg" role="alert">
                <span class="font-bold">{% trans "Xatoliklar:" %}</span>
                {{ form.non_field_errors }}
            </div>
        {% endif %}

        <form method="post">
            {% csrf_token %}
            
            {# 1. Teg nomi (Name) #}
            <div class="mb-6">
                <label for="{{ form.name.id_for_label }}" class="block text-base font-semibold text-gray-700 mb-2">
                    {{ form.name.label }} <span class="text-red-500">*</span>
                </label>
                {% render_field form.name class="form-control mt-1 block w-full" type="text" placeholder="Masalan: Kvadrat tenglamalar, Algebra..." %}
                {% for error in form.name.errors %}
                    <p class="text-sm text-red-600 mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            {# 2. Asosiy teg (Parent) #}
            <div class="mb-6">
                <label for="{{ form.parent.id_for_label }}" class="block text-base font-semibold text-gray-700 mb-2">
                    {{ form.parent.label }}
                </label>
                {% render_field form.parent class="form-control mt-1 block w-full" placeholder="Asosiy tegni tanlang (Masalan: Matematika)" %}
                {% for error in form.parent.errors %}
                    <p class="text-sm text-red-600 mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            {# 3. Tavsif (Description) #}
            <div class="mb-8">
                <label for="{{ form.description.id_for_label }}" class="block text-base font-semibold text-gray-700 mb-2">
                    {{ form.description.label }}
                </label>
                {% render_field form.description class="form-control mt-1 block w-full" rows="4" placeholder="Mavzuning qisqacha tavsifi..." %}
                
                {% if form.description.help_text %}
                    <p class="text-xs text-gray-500 mt-1">{{ form.description.help_text|safe }}</p>
                {% endif %}
                {% for error in form.description.errors %}
                    <p class="text-sm text-red-600 mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            
            {# Tugmalar bloki: Responsivlik kuchaytirilgan #}
            <div class="flex flex-col sm:flex-row justify-end mt-8 space-y-3 sm:space-y-0 sm:space-x-4 border-t border-gray-100 pt-6">
                
                {# Bekor qilish tugmasi #}
                <a href="{% url 'tag_list' slug=center.slug %}" class="btn btn-secondary w-full sm:w-auto order-2 sm:order-1">
                    <i class="fas fa-times mr-2"></i>{% trans "Bekor qilish" %}
                </a>
                
                {# Saqlash/Tahrirlash tugmasi #}
                <button type="submit" class="btn btn-primary w-full sm:w-auto shadow-lg shadow-indigo-200 hover:shadow-indigo-300 order-1 sm:order-2">
                    <i class="fas fa-save mr-2"></i>
                    {% if form.instance.pk %}
                        {% trans "O'zgarishlarni saqlash" %}
                    {% else %}
                        {% trans "Tegni yaratish" %}
                    {% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock content %}